# 7. Ввод и вывод

[Оригинал](https://docs.python.org/3.12/tutorial/inputoutput.html)

Программа выводит данные несколькими способами — отображение человеку понятной формы или запись в файл для последующего использования.

## 7.1. Форматированный вывод

Есть несколько способов управления форматом вывода программы.

### 7.1.1. Форматированные строковые литералы

Форматированные строки начинаются с префикса `f` или `F`. Внутри такой строки выражения заключаются в фигурные скобки `{ }`.

```python
year = 2016
event = 'Referendum'
f'Результаты {year}-го года {event}'
# Результаты 2016-го года Referendum
```

Можно указать спецификаторы формата после двоеточия внутри фигурных скобок:

```python
import math
print(f'Значение числа π примерно равно {math.pi:.3f}.')
# Значение числа π примерно равно 3.142.
```

Также можно задать минимальную ширину поля:

```python
table = {'Sjoerd': 4127, 'Jack': 4098, 'Dcab': 7678}
for name, phone in table.items():
    print(f'{name:10} => {phone:10d}')
# Sjoerd     =>       4127
# Jack       =>       4098
# Dcab       =>       7678
```

Модификаторы позволяют преобразовывать значение перед форматированием:

```python
animals = 'eels'
print(f'My hovercraft is full of {animals!r}.')
# My hovercraft is full of 'eels'.
```

Спецификатор `=` позволяет расширить выражение до имени переменной и её представления:

```python
bugs = 'roaches'
count = 13
area = 'living room'
print(f'Debugging {bugs=}, {count=}, {area=}')
# Debugging bugs='roaches', count=13, area='living room'
```

### 7.1.2. Метод str.format()

Метод `.format()` заменяет специальные символы (`{}`) значениями аргументов функции.

Простое использование метода:

```python
print('Мы {0}, кто говорят "{1}"'.format('рыцари', 'Ни'))
# Мы рыцари, кто говорят "Ни"
```

Позиция аргумента задаётся числом внутри фигурных скобок:

```python
print('{0} и {1}'.format('спам', 'яйца'))
# спам и яйца
```

Ключевые аргументы используются по именам:

```python
print('Это {food} абсолютно ужасное.'.format(
    food='спам',
    adjective='абсолютно ужасное'
))
# Это спам абсолютно ужасное.
```

Комбинирование позиционных и ключевых аргументов:

```python
print('История про {0}, {1}, и {other}.'.format('Билл', 'Манфред', other='Георг'))
# История про Билл, Манфред, и Георг.
```

Доступ к элементам словаря через квадратные скобки:

```python
table = {'Sjoerd': 4127, 'Jack': 4098, 'Dcab': 8637678}
print('Jack: {0[Jack]:d}; Sjoerd: {0[Sjoerd]:d}; Dcab: {0[Dcab]:d}'.format(table))
# Jack: 4098; Sjoerd: 4127; Dcab: 8637678
```

Или используя распаковку словаря:

```python
table = {'Sjoerd': 4127, 'Jack': 4098, 'Dcab': 8637678}
print('Jack: {Jack:d}; Sjoerd: {Sjoerd:d}; Dcab: {Dcab:d}'.format(**table))
# Jack: 4098; Sjoerd: 4127; Dcab: 8637678
```

### 7.1.3. Ручная обработка строк

Для выравнивания столбцов вручную используется метод `.rjust()`:

```python
for x in range(1, 11):
    print(repr(x).rjust(2), repr(x*x).rjust(3), repr(x*x*x).rjust(4))
#  1   1    1
#  2   4    8
# ...
```

Другие методы работы со строками:

- `.ljust()` — выравнивание слева
- `.center()` — центрирование
- `.zfill()` — заполнение нулями слева

Пример заполнения нулями:

```python
'12'.zfill(5)
# '00012'
```

### 7.1.4. Старый способ форматирования строк

Оператор `%` также поддерживает форматирование строк:

```python
import math
print('Число π приблизительно равно %5.3f.' % math.pi)
# Число π приблизительно равно 3.142.
```

Подробности см. в разделе [printf-style String Formatting](../library/stdtypes.html#old-string-formatting).

## 7.2. Чтение и запись файлов

Функция `open()` возвращает объект файла и принимает два обязательных аргумента и один необязательный:

```python
f = open('workfile', 'w', encoding='utf-8')
```

Режимы открытия файла:

- `'r'` — чтение
- `'w'` — перезапись
- `'a'` — дозапись
- `'r+'` — чтение и запись
- `'b'` — бинарный режим

Рекомендуемый способ работы с файлами — использование конструкции `with`, обеспечивающей автоматическое закрытие файла:

```python
with open('workfile', encoding='utf-8') as f:
    read_data = f.read()
```

Методы объекта файла:

- `.read()` — читает содержимое файла целиком или заданную длину символов
- `.readline()` — читает одну строку
- `.writelines(lines)` — записывает список строк
- `.write(string)` — пишет строку
- `.tell()` — возвращает текущее положение указателя чтения-записи
- `.seek(offset[, whence])` — перемещает указатель чтения-записи

Примеры методов:

```python
f.read()
# 'This is the entire file.'

f.read()
# ''

f.readline()
# 'Первая строка файла.\n'

f.write('Тестовая строка\n')
# 15
```

Запись произвольных объектов требует предварительного преобразования в строку:

```python
value = ('ответ', 42)
s = str(value)
f.write(s)
# 18
```

Работа с позициями в файле:

```python
f = open('workfile', 'rb+')
f.write(b'0123456789abcdef')
f.seek(5)
f.read(1)
# b'5'
```

## 7.2.2. Сохранение структурированных данных с помощью модуля json

Python поддерживает популярный формат обмена данными JSON. Модуль `json` позволяет сериализовать объекты Python в строки JSON и обратно.

Пример сериализации списка:

```python
import json
x = [1, 'простая', 'строка']
json.dumps(x)
# '[1, "простая", "строка"]'
```

Сериализация в файл:

```python
json.dump(x, f)
```

Десериализация из файла:

```python
x = json.load(f)
```

Примечание: файлы JSON должны быть закодированы в UTF-8. Используйте параметр `encoding="utf-8"` при открытии файла.

Альтернативный модуль для сериализации сложных объектов — `pickle`, однако он специфичен для Python и небезопасен при работе с недоверенными источниками.
